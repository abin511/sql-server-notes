/*获取汉字首个字母的函数
SELECT * FROM DBO.[GET_INITIALS]('湖北 浙江 CH 陈浩') 
*/
CREATE FUNCTION [DBO].[GET_INITIALS](@STR VARCHAR(500)='')
--RETURNS VARCHAR(500)
RETURNS @T TABLE(COL VARCHAR(500)) 
AS
BEGIN--函数实现开始
	DECLARE @STRLEN INT SET @STRLEN = LEN(@STR)
	DECLARE @RETURN VARCHAR(500) SET @RETURN = ''
	DECLARE @I INT SET @I = 0
	
	DECLARE @N INT,@C CHAR(1),@CHN NCHAR(1) 
	--WHILE循环开始
	WHILE @I< @STRLEN BEGIN
		SELECT @I=@I+1,@N=63,@CHN=SUBSTRING(@STR,@I,1)
		--IF开始
		IF @CHN > 'Z'
		--此处只有一个 SELECT 语句，原理以“字符串排序以及ASCII码表”：
			SELECT @N = @N +1,@C = CASE CHN WHEN @CHN THEN CHAR(@N) ELSE @C END FROM( 
				SELECT TOP 27 * FROM (
					SELECT CHN = '吖'
					UNION ALL SELECT '八'
					UNION ALL SELECT '嚓'
					UNION ALL SELECT ''
					UNION ALL SELECT ''
					UNION ALL SELECT '发'
					UNION ALL SELECT '旮'
					UNION ALL SELECT '铪'
					UNION ALL SELECT '丌' --BECAUSE HAVE NO 'I'
					UNION ALL SELECT '丌'
					UNION ALL SELECT '咔'
					UNION ALL SELECT '垃'
					UNION ALL SELECT '`'
					UNION ALL SELECT ''
					UNION ALL SELECT '噢'
					UNION ALL SELECT 'r'
					UNION ALL SELECT '七'
					UNION ALL SELECT ''
					UNION ALL SELECT '仨'
					UNION ALL SELECT '他'
					UNION ALL SELECT '' --NO 'U'
					UNION ALL SELECT '' --NO 'V'
					UNION ALL SELECT ''
					UNION ALL SELECT '夕'
					UNION ALL SELECT '丫'
					UNION ALL SELECT ''
					UNION ALL SELECT @CHN) AS A
					ORDER BY CHN COLLATE CHINESE_PRC_CI_AS 
				) AS B 
		ELSE --IF对应的ELSE 
			SET @C=@CHN 
		--IF结束
		SET @RETURN=@RETURN+@C 
	END--WHILE循环结束
	--RETURN(@RETURN)
	INSERT @T(COL) VALUES(@RETURN)   
    RETURN  
END--函数实现结束